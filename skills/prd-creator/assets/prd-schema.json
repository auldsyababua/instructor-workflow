{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "LLM-Native Product Requirements Document",
  "description": "JSON Schema for validating LLM-native PRD structure when using pure JSON format",
  "type": "object",
  "properties": {
    "metadata": {
      "type": "object",
      "description": "Document metadata and configuration",
      "properties": {
        "version": {
          "type": "string",
          "pattern": "^\\d+\\.\\d+\\.\\d+$",
          "description": "Semantic version (e.g., 1.0.0)"
        },
        "owner": {
          "type": "string",
          "description": "Product owner or responsible party"
        },
        "status": {
          "enum": ["draft", "in-review", "approved"],
          "description": "Document status"
        },
        "last_updated": {
          "type": "string",
          "format": "date",
          "description": "Last update date in YYYY-MM-DD format"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "uri"
          },
          "description": "Links to related documents"
        },
        "llm_directives": {
          "type": "object",
          "properties": {
            "model": {
              "type": "string",
              "description": "Target LLM model"
            },
            "temperature": {
              "type": "number",
              "minimum": 0,
              "maximum": 2,
              "description": "LLM temperature setting"
            },
            "persona": {
              "type": "string",
              "description": "Persona instructions for LLM"
            }
          }
        }
      },
      "required": ["version", "owner", "status", "last_updated"]
    },
    "overviewAndGoals": {
      "type": "object",
      "description": "High-level product context",
      "properties": {
        "productSummary": {
          "type": "string",
          "minLength": 50,
          "description": "Brief summary of the product or feature"
        },
        "businessGoals": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^Goal-\\d{3}$",
                "description": "Unique goal ID (e.g., Goal-001)"
              },
              "description": {
                "type": "string",
                "description": "Goal description with measurable target"
              }
            },
            "required": ["id", "description"]
          },
          "minItems": 1
        }
      },
      "required": ["productSummary", "businessGoals"]
    },
    "technicalConstraints": {
      "type": "object",
      "description": "Immutable technical rules and environment",
      "properties": {
        "languages": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Programming languages with versions"
        },
        "frameworks": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Frameworks with versions"
        },
        "databases": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Database systems with versions"
        },
        "styleGuides": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Code style guides and linting configs"
        },
        "security": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Security requirements and protocols"
        },
        "forbidden": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Explicitly forbidden libraries or patterns"
        }
      },
      "required": ["languages"]
    },
    "userPersonas": {
      "type": "array",
      "description": "Actors who interact with the system",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^Persona-[A-Z][a-z]+$",
            "description": "Unique persona ID (e.g., Persona-Admin)"
          },
          "description": {
            "type": "string",
            "description": "Persona description, permissions, and goals"
          }
        },
        "required": ["id", "description"]
      },
      "minItems": 1
    },
    "functionalRequirements": {
      "type": "array",
      "description": "User stories with acceptance criteria",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^US-\\d{3}$",
            "description": "Unique user story ID (e.g., US-001)"
          },
          "asA": {
            "type": "string",
            "description": "User persona"
          },
          "iWantTo": {
            "type": "string",
            "description": "Desired action or capability"
          },
          "soThat": {
            "type": "string",
            "description": "Benefit or value delivered"
          },
          "acceptanceCriteria": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "type": "string",
                  "pattern": "^AC-\\d{3}-[A-Z]$",
                  "description": "Unique AC ID (e.g., AC-001-A)"
                },
                "description": {
                  "type": "string",
                  "description": "Testable condition with MUST/SHOULD/MAY"
                }
              },
              "required": ["id", "description"]
            },
            "minItems": 1
          }
        },
        "required": ["id", "asA", "iWantTo", "soThat", "acceptanceCriteria"]
      },
      "minItems": 1
    },
    "nonFunctionalRequirements": {
      "type": "array",
      "description": "System-wide quality attributes",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^NFR-[A-Za-z]+-\\d{3}$",
            "description": "Unique NFR ID with category (e.g., NFR-Perf-001)"
          },
          "category": {
            "enum": ["Performance", "Security", "Scalability", "Accessibility", "Availability", "Maintainability"],
            "description": "NFR category"
          },
          "description": {
            "type": "string",
            "description": "Measurable quality requirement"
          }
        },
        "required": ["id", "category", "description"]
      }
    },
    "outOfScope": {
      "type": "array",
      "description": "Explicitly excluded features to prevent hallucination",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "successMetrics": {
      "type": "object",
      "description": "KPIs and analytics events",
      "properties": {
        "kpis": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^KPI-\\d{3}$",
                "description": "Unique KPI ID (e.g., KPI-001)"
              },
              "description": {
                "type": "string",
                "description": "Metric with target value"
              }
            },
            "required": ["id", "description"]
          }
        },
        "analyticsEvents": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "pattern": "^Analytics-Event-\\d{3}$",
                "description": "Unique event ID"
              },
              "eventName": {
                "type": "string",
                "description": "Analytics event name"
              },
              "trigger": {
                "type": "string",
                "description": "When this event fires"
              }
            },
            "required": ["id", "eventName", "trigger"]
          }
        }
      }
    }
  },
  "required": [
    "metadata",
    "overviewAndGoals",
    "technicalConstraints",
    "userPersonas",
    "functionalRequirements",
    "outOfScope",
    "successMetrics"
  ]
}
